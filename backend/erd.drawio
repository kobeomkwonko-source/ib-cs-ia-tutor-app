<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2026-02-15T00:00:00.000Z" agent="codex" version="20.8.16" type="device">
  <diagram id="erd" name="ERD">
    <mxGraphModel dx="1229" dy="768" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="1000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Users -->
        <mxCell id="users" value="users\n- id (PK)\n- username (UQ)\n- email (UQ, nullable)\n- password\n- role (tutor|student)\n- points" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8f8f8;strokeColor=#333;" vertex="1" parent="1">
          <mxGeometry x="60" y="60" width="260" height="190" as="geometry" />
        </mxCell>

        <!-- Tasks -->
        <mxCell id="tasks" value="tasks\n- id (PK)\n- title\n- description\n- pdf_path (nullable)\n- points\n- deadline\n- created_by (FK -> users.id, nullable)\n- created_at\n- updated_at (nullable)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8f8f8;strokeColor=#333;" vertex="1" parent="1">
          <mxGeometry x="420" y="40" width="320" height="230" as="geometry" />
        </mxCell>

        <!-- Task Assignments -->
        <mxCell id="task_assignments" value="task_assignments\n- id (PK)\n- task_id (FK -> tasks.id)\n- student_id (FK -> users.id)\n- assigned_by (FK -> users.id)\n- assigned_at\n- uniq(task_id, student_id)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8f8f8;strokeColor=#333;" vertex="1" parent="1">
          <mxGeometry x="420" y="310" width="320" height="200" as="geometry" />
        </mxCell>

        <!-- Submissions -->
        <mxCell id="submissions" value="submissions\n- id (PK)\n- task_id (FK -> tasks.id)\n- student_id (FK -> users.id)\n- submitted_at\n- text_content (nullable)\n- pdf_path (nullable)\n- teacher_comment (nullable)\n- awarded_points (nullable)\n- awarded_at (nullable)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8f8f8;strokeColor=#333;" vertex="1" parent="1">
          <mxGeometry x="420" y="560" width="320" height="230" as="geometry" />
        </mxCell>

        <!-- Reminder Logs -->
        <mxCell id="reminder_logs" value="reminder_logs\n- id (PK)\n- task_id (FK -> tasks.id)\n- student_id (FK -> users.id)\n- reminder_type (24h|12h)\n- sent_at\n- uniq(task_id, student_id, reminder_type)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8f8f8;strokeColor=#333;" vertex="1" parent="1">
          <mxGeometry x="780" y="310" width="320" height="190" as="geometry" />
        </mxCell>

        <!-- Rewards -->
        <mxCell id="rewards" value="rewards\n- id (PK)\n- title\n- description (nullable)\n- cost\n- created_by (FK -> users.id)\n- active\n- created_at\n- updated_at (nullable)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8f8f8;strokeColor=#333;" vertex="1" parent="1">
          <mxGeometry x="60" y="310" width="300" height="210" as="geometry" />
        </mxCell>

        <!-- Purchases -->
        <mxCell id="purchases" value="purchases\n- id (PK)\n- reward_id (FK -> rewards.id, nullable)\n- student_id (FK -> users.id, nullable)\n- purchased_at\n- cost_at_purchase" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8f8f8;strokeColor=#333;" vertex="1" parent="1">
          <mxGeometry x="60" y="570" width="300" height="170" as="geometry" />
        </mxCell>

        <!-- Reward Purchase Ledger -->
        <mxCell id="reward_purchase_ledger" value="reward_purchase_ledger\n- id (PK)\n- purchase_id (FK -> purchases.id, nullable)\n- reward_id (FK -> rewards.id, nullable)\n- student_id (FK -> users.id, nullable)\n- reward_title\n- reward_description (nullable)\n- reward_cost\n- cost_at_purchase\n- student_username\n- student_email (nullable)\n- points_before\n- points_after\n- purchased_at\n- created_at" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8f8f8;strokeColor=#333;" vertex="1" parent="1">
          <mxGeometry x="780" y="560" width="320" height="300" as="geometry" />
        </mxCell>

        <!-- Relationships -->
        <mxCell id="edge_users_tasks" style="endArrow=block;html=1;strokeColor=#555;" edge="1" parent="1" source="tasks" target="users">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge_users_rewards" style="endArrow=block;html=1;strokeColor=#555;" edge="1" parent="1" source="rewards" target="users">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge_assignments_tasks" style="endArrow=block;html=1;strokeColor=#555;" edge="1" parent="1" source="task_assignments" target="tasks">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge_assignments_students" style="endArrow=block;html=1;strokeColor=#555;" edge="1" parent="1" source="task_assignments" target="users">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge_submissions_tasks" style="endArrow=block;html=1;strokeColor=#555;" edge="1" parent="1" source="submissions" target="tasks">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge_submissions_students" style="endArrow=block;html=1;strokeColor=#555;" edge="1" parent="1" source="submissions" target="users">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge_reminders_tasks" style="endArrow=block;html=1;strokeColor=#555;" edge="1" parent="1" source="reminder_logs" target="tasks">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge_reminders_students" style="endArrow=block;html=1;strokeColor=#555;" edge="1" parent="1" source="reminder_logs" target="users">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge_purchases_rewards" style="endArrow=block;html=1;strokeColor=#555;" edge="1" parent="1" source="purchases" target="rewards">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge_purchases_students" style="endArrow=block;html=1;strokeColor=#555;" edge="1" parent="1" source="purchases" target="users">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge_ledger_purchases" style="endArrow=block;html=1;strokeColor=#555;" edge="1" parent="1" source="reward_purchase_ledger" target="purchases">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge_ledger_rewards" style="endArrow=block;html=1;strokeColor=#555;" edge="1" parent="1" source="reward_purchase_ledger" target="rewards">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge_ledger_students" style="endArrow=block;html=1;strokeColor=#555;" edge="1" parent="1" source="reward_purchase_ledger" target="users">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
